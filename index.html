<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinkTiles</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-shell">
        <!-- Main toolbar spanning full width -->
        <div class="main-toolbar">
          <div class="toolbar-logo">
            <a href="https://lankytuesday.github.io/Life_tiles/" target="_blank" rel="noopener">
              <img src="headericon.svg" alt="LinkTiles Logo" class="sidebar-logo">
            </a>
          </div>
          <div class="toolbar-search-container">
            <input type="text" id="sidebar-search" class="toolbar-search" placeholder="Search spaces, projects, tiles..." aria-label="Search spaces, projects, and tiles">
            <div id="search-results" class="search-results hidden"></div>
          </div>
          <button id="tabs-panel-toggle" class="tabs-panel-toggle-btn" title="Browser Tabs" aria-label="Browser Tabs">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                 viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                 stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <rect x="3" y="3" width="18" height="18" rx="2"/>
              <line x1="15" y1="3" x2="15" y2="21"/>
            </svg>
          </button>
          <div class="settings-wrapper">
            <button id="open-settings" class="settings-btn" title="Settings" aria-label="Settings">
              <!-- filled gear (legible at small sizes) -->
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                   viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path d="M19.14 12.94c.04-.31.06-.63.06-.94s-.02-.63-.06-.94l2.03-1.58a.5.5 0 0 0 .12-.64l-1.92-3.32a.5.5 0 0 0-.6-.22l-2.39.96c-.49-.4-1.05-.72-1.63-.94l-.36-2.54A.5.5 0 0 0 13.9 2h-3.8a.5.5 0 0 0-.49.41l-.36 2.54c-.58.23-1.13.53-1.63.94l-2.39-.96a.5.5 0 0 0-.6.22L2.72 7.98a.5.5 0 0 0 .12.64l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58a.5.5 0 0 0-.12.64l1.92 3.32c.13.22.39.31.6.22l2.39-.96c.5.41 1.05.72 1.63.94l.36 2.54c.05.24.25.41.49.41h3.8c.24 0 .44-.17.49-.41l.36-2.54c.58-.23 1.13-.53 1.63-.94l2.39.96c.22.09.47 0 .6-.22l1.92-3.32a.5.5 0 0 0-.12-.64l-2.03-1.58ZM12 15.5a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7Z"/>
              </svg>
            </button>
          </div>
        </div>

        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar" aria-label="Spaces navigation">
            <ul id="sidebar-list" class="sidebar-list" role="listbox" aria-label="Spaces">
                <!-- Dashboard items will be inserted here -->
            </ul>
        </aside>

        <!-- Main content area -->
        <main id="main">
            <div id="onboarding-pin-banner">
                <span class="pin-banner-text">
                    Can't find the LinkTiles icon on the toolbar? Click the
                    <svg class="pin-banner-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M20.5 11H19V7c0-1.1-.9-2-2-2h-4V3.5a2.5 2.5 0 0 0-5 0V5H4c-1.1 0-2 .9-2 2v3.8h1.5c1.4 0 2.5 1.1 2.5 2.5s-1.1 2.5-2.5 2.5H2V19c0 1.1.9 2 2 2h3.8v-1.5c0-1.4 1.1-2.5 2.5-2.5s2.5 1.1 2.5 2.5V21H16c1.1 0 2-.9 2-2v-4h1.5a2.5 2.5 0 0 0 0-5Z"/></svg>
                    puzzle icon and then pin
                    <svg class="pin-banner-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M16 12V4h1V2H7v2h1v8l-2 2v2h5.2v6h1.6v-6H18v-2l-2-2Z"/></svg>
                    LinkTiles for easy access.
                </span>
                <span class="pin-banner-arrow" aria-hidden="true">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="19" x2="12" y2="5"/><polyline points="5 12 12 5 19 12"/></svg>
                </span>
                <button id="pin-banner-dismiss" class="pin-banner-dismiss" title="Dismiss" aria-label="Dismiss banner">&times;</button>
            </div>

                <div id="projects-container">
                    <div class="project-controls">
                        <button id="new-project" class="new-project">+ New Project</button>
                        <span id="current-dashboard-title" class="dashboard-title"></span>
                        <div class="project-controls-right">
                            <button id="expand-all" class="project-control-btn">+ Expand All</button>
                            <button id="collapse-all" class="project-control-btn">âˆ’ Collapse All</button>
                            <button id="bulk-select" class="project-control-btn">Select</button>
                        </div>
                    </div>
                    <div id="bulk-action-bar" class="bulk-action-bar hidden">
                        <span id="selection-count">0 selected</span>
                        <div class="bulk-action-buttons">
                            <button id="bulk-toggle-all" class="bulk-btn bulk-toggle-all" title="Select all / Deselect all">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="18" height="18" rx="2"/>
                                    <path class="checkmark" d="M9 12l2 2 4-4"/>
                                </svg>
                                Select all
                            </button>
                            <button id="bulk-delete" class="bulk-btn bulk-delete" disabled>Delete</button>
                            <button id="bulk-move" class="bulk-btn" disabled>Move to...</button>
                            <button id="bulk-copy" class="bulk-btn" disabled>Copy to...</button>
                            <button id="bulk-cancel" class="bulk-btn">Cancel</button>
                        </div>
                    </div>
                    <div id="projects-list"></div>
                </div>
              </main>

        <!-- Browser Tabs Panel -->
        <aside id="tabs-panel" class="tabs-panel">
          <div class="tabs-panel-header">
            <span class="tabs-panel-title">Browser Tabs</span>
            <span id="tabs-panel-count" class="tabs-panel-count">0</span>
          </div>
          <div class="tabs-panel-actions">
            <label class="tabs-panel-select-all-label">
              <input type="checkbox" id="tabs-panel-select-all">
              <span>Select All</span>
            </label>
            <button id="tabs-panel-refresh" class="tabs-panel-refresh-btn" title="Refresh">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="23 4 23 10 17 10"/>
                <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
              </svg>
            </button>
          </div>
          <div id="tabs-panel-list" class="tabs-panel-list">
            <!-- Tab items rendered by JS -->
          </div>
          <div id="tabs-panel-save-bar" class="tabs-panel-save-bar hidden">
            <span id="tabs-panel-sel-count">0 selected</span>
            <button id="tabs-panel-save-btn" class="tabs-panel-save-btn">Save to Project...</button>
          </div>
        </aside>

            <!-- Project Creation Modal -->
            <div id="project-modal" class="modal">
                <div class="modal-content">
                    <h2>Create New Project</h2>
                    <input type="text" id="project-name-input" placeholder="Enter project name">
                    <div class="modal-buttons">
                        <button id="close-modal" class="cancel-button">Cancel</button>
                        <button id="submit-project-name" class="done-button" disabled>Done</button>
                    </div>
                </div>
            </div>

            <!-- Tile Creation Modal -->
            <div id="tile-modal" class="modal">
                <div class="modal-content">
                    <h2>Create New Tile</h2>
                    <input type="text" id="tile-name-input" placeholder="Enter tile name">
                    <input type="url" id="tile-url-input" placeholder="Enter URL (https://...)">
                    <div class="modal-buttons">
                        <button id="close-tile-modal" class="cancel-button">Cancel</button>
                        <button id="submit-tile" class="done-button" disabled>Done</button>
                    </div>
                </div>
            </div>

            <!-- Dashboard Creation/Edit Modal -->
            <div id="dashboard-modal" class="modal">
                <div class="modal-content">
                    <h2>Create New Space</h2>
                    <input type="text" id="dashboard-name-input" placeholder="Enter space name">

                    <div class="modal-buttons">
                        <button id="close-dashboard-modal" class="cancel-button">Cancel</button>
                        <button id="submit-dashboard-name" class="done-button" disabled>Done</button>
                    </div>
                </div>
            </div>

            <!-- Popup Save Tile Modal -->
            <div id="popup-save-modal" class="modal">
                <div class="modal-content">
                    <h2>Save to LinkTiles</h2>
                    <input type="text" id="popup-tile-name-input" placeholder="Enter tile name">
                    <input type="url" id="popup-tile-url-input" placeholder="URL" readonly>
                    <div class="modal-buttons">
                        <button id="close-popup-modal" class="cancel-button">Cancel</button>
                        <button id="submit-popup-tile" class="done-button" disabled>Done</button>
                    </div>
                </div>
            </div>

            <!-- Bulk Move/Copy Target Modal (for projects - simple dropdown) -->
            <div id="bulk-target-modal" class="modal">
                <div class="modal-content">
                    <h2 id="bulk-target-title">Move to</h2>
                    <select id="bulk-target-select">
                        <!-- Options populated dynamically -->
                    </select>
                    <div class="modal-buttons">
                        <button id="bulk-target-cancel" class="cancel-button">Cancel</button>
                        <button id="bulk-target-confirm" class="done-button">Confirm</button>
                    </div>
                </div>
            </div>

            <!-- Bulk Move/Copy Target Modal (for tiles - tree structure) -->
            <div id="bulk-tile-target-modal" class="modal">
                <div class="modal-content" style="width: 320px;">
                    <h2 id="bulk-tile-target-title">Move to Project</h2>
                    <div id="bulk-tile-target-tree" class="target-tree">
                        <!-- Tree populated dynamically -->
                    </div>
                    <div class="modal-buttons">
                        <button id="bulk-tile-target-cancel" class="cancel-button">Cancel</button>
                        <button id="bulk-tile-target-confirm" class="done-button" disabled>Confirm</button>
                    </div>
                </div>
            </div>

            <!-- Manage Dashboards Modal -->
            <div id="manage-dashboards-modal" class="modal">
                <div class="modal-content" style="width: 480px; max-width: 90vw;">
                    <h2>Manage Spaces</h2>
                    <div id="manage-dashboards-list" class="manage-dashboards-list">
                        <!-- Dashboard items will be populated here -->
                    </div>
                    <div class="modal-buttons">
                        <button id="close-manage-dashboards" class="cancel-button">Close</button>
                    </div>
                </div>
            </div>

            <!-- Space Edit Modal (name + color picker) -->
            <div id="space-edit-modal" class="modal">
                <div class="modal-content space-edit-modal-content">
                    <h2>Edit Space</h2>
                    <input type="text" id="space-edit-name-input" placeholder="Space name">
                    <div class="color-picker-section">
                        <label class="color-picker-label">Color</label>
                        <div class="color-swatches" id="space-edit-swatches">
                            <button type="button" class="color-swatch" data-color="#f4a5a5" style="background:#f4a5a5" title="Rose"></button>
                            <button type="button" class="color-swatch" data-color="#f4c78e" style="background:#f4c78e" title="Peach"></button>
                            <button type="button" class="color-swatch" data-color="#f9e98e" style="background:#f9e98e" title="Yellow"></button>
                            <button type="button" class="color-swatch" data-color="#a5d6a7" style="background:#a5d6a7" title="Mint"></button>
                            <button type="button" class="color-swatch" data-color="#a5d0f4" style="background:#a5d0f4" title="Sky"></button>
                            <button type="button" class="color-swatch" data-color="#b3a5f4" style="background:#b3a5f4" title="Lavender"></button>
                            <button type="button" class="color-swatch" data-color="#f4a5d8" style="background:#f4a5d8" title="Pink"></button>
                            <button type="button" class="color-swatch" data-color="#c4c4c4" style="background:#c4c4c4" title="Gray"></button>
                            <button type="button" class="color-swatch color-swatch-none" data-color="" title="None"></button>
                        </div>
                    </div>
                    <div class="modal-buttons">
                        <button id="space-edit-cancel" class="cancel-button">Cancel</button>
                        <button id="space-edit-save" class="done-button" disabled>Save</button>
                    </div>
                </div>
            </div>

            <!-- Welcome Modal (First Run) -->
            <div id="welcome-modal" class="modal">
                <div class="modal-content" style="max-width: 320px;">
                    <h2>Welcome to LinkTiles!</h2>
                    <p style="margin: 16px 0; color: #666; font-size: 14px; line-height: 1.5;">
                        Organize your bookmarks into spaces and projects.
                    </p>
                    <div class="modal-buttons" style="flex-direction: column; gap: 10px;">
                        <button id="welcome-import" class="done-button enabled">Import Bookmarks</button>
                        <button id="welcome-start-fresh" class="cancel-button">Start Fresh</button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="Sortable.min.js"></script>
    <script src="dexie.min.js"></script>
    <script src="db.js"></script>
    <script src="script.js"></script>
</body>
</html>